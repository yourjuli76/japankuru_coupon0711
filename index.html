<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Japankuru ã‚¯ãƒ¼ãƒãƒ³ãƒšãƒ¼ã‚¸ (0708)</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.css"/>
  <style>
    /* --- ê¸°ë³¸ & í…Œë§ˆ ì„¤ì • --- */
    :root {
      --primary-color: #007bff;
      --danger-color: #d90429;
      --save-color: #ffc107;
      --dark-blue: #1a2c4e;
      --card-bg: #fff;
      --light-gray: #f0f2f5;
      --border-color: #d1d9e6;
      --tag-bg: #e7f1ff;
      --tag-color: #004aad;
      --tag-border: #d1d4ff;
      --subtle-text: #666;
      --flip-btn-bg: #e9ecef;
      --flip-btn-color: #555;
    }
    body.dark-mode {
      --light-gray: #121212;
      --card-bg: #1e1e1e;
      --dark-blue: #2c3e50;
      --border-color: #444;
      --tag-bg: #2a3a5e;
      --tag-color: #a7c5ff;
      --tag-border: #3f517a;
      --subtle-text: #aaa;
      --flip-btn-bg: #343a40;
      --flip-btn-color: #f1f3f5;
    }
    
    /* --- Reset & Base Typography --- */
    body {
      background: #f5f6fa;
      color: #222;
      font-family: 'SF Pro Display','Noto Sans JP','Helvetica Neue',Arial,sans-serif;
      letter-spacing: 0.02em;
      font-size: 17px;
    }
    a { color: inherit; text-decoration: none; }
    a:hover { text-decoration: underline; }
    
    /* --- Header / Hero Section --- */
    .site-header-hero {
      position: relative;
      background-image:
        linear-gradient(rgba(26,44,78,0.68),rgba(26,44,78,0.75)),
        url('https://images.unsplash.com/photo-1542051841857-5f90071e7989?auto=format&fit=crop&w=2070&q=80');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      color: #fff;
      text-align: center;
      padding: 28px 10px 96px;
      box-shadow: 0 2px 28px rgba(30,50,90,0.04);
      overflow: hidden;
    }
    .nav-row, .nav-container {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: relative;
      z-index: 2;
    }
    .nav-logo-link img { height: 35px; filter: brightness(0) invert(1); }
    .theme-switcher { display: flex; align-items: center; gap: 8px; color: white; }
    .theme-toggle {
      width: 40px; height: 20px;
      background: rgba(255,255,255,0.4);
      border-radius: 10px; position: relative; cursor: pointer;
    }
    .theme-toggle::before {
      content: '';
      position: absolute;
      width: 16px; height: 16px;
      background: white; border-radius: 50%;
      top: 2px; left: 2px; transition: transform .3s;
    }
    body.dark-mode .theme-toggle::before { transform: translateX(20px); }
    
    .hero-content {
      margin-top: 60px;
      background: rgba(255,255,255,0.11);
      border-radius: 32px;
      padding: 34px;
      box-shadow: 0 8px 28px rgba(0,20,60,0.10);
      display: inline-block;
      position: relative; z-index: 2;
      animation: fadeInUp .9s cubic-bezier(.22,.68,.38,1.08);
    }
    .hero-content h1 {
      font-family: 'SF Pro Display','Noto Serif JP',serif;
      font-size: 2.9em; font-weight: 900;
      margin: 24px 0 10px;
      letter-spacing: .05em; line-height: 1.12; color: #fff;
      text-shadow: 0 3px 18px rgba(24,24,48,0.24);
      animation: heroPop .8s .13s cubic-bezier(.27,.95,.51,1.3) backwards;
    }
    .hero-content b { color: #ffc107; }
    .hero-sub { font-size: 1.15em; margin-top: 10px; opacity: .98; }
    .hero-sub .sparkle { animation: sparkleAnim 2.3s infinite; display: inline-block; }
    
    @keyframes sparkleAnim{0%{opacity:.2}48%{opacity:1}100%{opacity:.2}}
    @keyframes heroPop{from{opacity:.3;transform:scale(.95)}to{opacity:1;transform:scale(1)}}
    @keyframes fadeInUp{0%{opacity:0;transform:translateY(22px)}100%{opacity:1;transform:translateY(0)}}
    
    .hero-content .hero-coupon-badge {
      display: inline-block;
      background: linear-gradient(90deg,#ffc107 0%,#ff5858 100%);
      color: #fff; border-radius: 16px;
      padding: 5px 22px; margin-bottom: 8px;
      font-size: 19px; font-weight: 800; letter-spacing: .02em;
      box-shadow: 0 2px 12px rgba(255,96,40,0.15);
      transform: rotate(-4deg); margin-right: 12px;
      animation: badgeSlide .7s .15s cubic-bezier(.5,1.7,.7,1.1) backwards;
    }
    @keyframes badgeSlide{from{transform:translateX(-120px) scale(.98) rotate(-7deg);opacity:0}to{transform:translateX(0) scale(1) rotate(-4deg);opacity:1}}
    
    .hero-search-form {
      margin-top: 25px;
      position: relative;
      max-width: 600px;
      margin: 0 auto;
    }
    .hero-search-form input {
      width: 100%;
      padding: 20px 60px 20px 25px;
      font-size: 18px;
      border-radius: 50px;
      border: 1px solid rgba(255,255,255,0.2);
      background: rgba(255,255,255,0.95);
      color: #333;
      box-shadow: 0 1.5px 10px rgba(20,50,100,0.10);
      box-sizing: border-box;
    }
    .hero-search-form .search-icon {
      position: absolute;
      right: 25px; top: 50%;
      transform: translateY(-50%);
      font-size: 20px; color: #888;
    }
    .hero-search-form .clear-btn {
      position: absolute;
      right: 60px;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
      font-size: 18px;
      color: #888;
      opacity: 0.6;
      transition: opacity .2s;
    }
    .hero-search-form .clear-btn:hover { opacity: 1; }
    
    /* --- HINT TEXT --- */
    .interaction-notice {
      text-align: center;
      margin: 20px auto;
      padding: 12px 20px;
      max-width: 600px;
      background: var(--tag-bg);
      color: var(--dark-blue);
      border-radius: 8px;
      font-size: 1.05em;
      font-weight: 500;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .interaction-notice b { color: var(--primary-color); }
    
    /* --- PICKUP SPECIAL COUPON AREA --- */
    .pickup-special-section {
      padding: 60px 20px; max-width: 1200px; margin: 0 auto;
    }
    .pickup-title-wrapper { text-align: center; margin-bottom: 40px; }
    .pickup-title {
      font-family: 'Noto Serif JP', serif;
      font-size: 2.5em; font-weight: 900; color: var(--dark-blue);
      margin: 0 0 10px; letter-spacing: .02em;
      position: relative; padding-bottom: 20px;
    }
    .pickup-title::after {
      content: '';
      position: absolute; left: 50%; bottom: 0;
      transform: translateX(-50%);
      width: 70px; height: 4px;
      background: linear-gradient(90deg,#ffc107,#ff8c2f);
      border-radius: 2px;
    }
    body.dark-mode .pickup-title { color: #fff; }
    .pickup-subtitle {
      font-size: 1.1em; color: var(--subtle-text);
      max-width: 600px; margin: 0 auto;
    }
    .pickup-grid {
      display: grid;
      grid-template-columns: 2fr 1fr;
      grid-template-rows: auto auto;
      gap: 25px;
    }
    .pickup-card {
      position: relative; border-radius: 20px; overflow: hidden;
      color: #fff; box-shadow: 0 8px 28px rgba(30,50,90,0.18);
      transition: transform .3s cubic-bezier(.22,.68,.38,1.08), box-shadow .3s;
      cursor: pointer;
    }
    .pickup-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 14px 36px rgba(40,60,120,0.22);
    }
    .pickup-card img {
      position: absolute; top: 0; left: 0;
      width: 100%; height: 100%; object-fit: cover;
      transition: transform .4s ease;
    }
    .pickup-card:hover img { transform: scale(1.05); }
    .pickup-overlay {
      position: absolute; top: 0; left: 0;
      width: 100%; height: 100%;
      background: linear-gradient(180deg,rgba(0,0,0,0)20%,rgba(0,0,0,0.2)50%,rgba(0,0,0,0.8)100%);
      z-index: 1;
    }
    .pickup-card:hover .pickup-overlay {
      background: linear-gradient(180deg,rgba(0,0,0,0.15)0%,rgba(0,0,0,0.5)40%,rgba(0,0,0,0.9)100%);
    }
    .pickup-content {
      position: relative; z-index: 2;
      padding: 25px;
      display: flex; flex-direction: column; justify-content: flex-end;
      height: 100%; box-sizing: border-box;
      text-shadow: 0 2px 8px rgba(0,0,0,0.5);
    }
    .pickup-badge {
      display: inline-block; align-self: flex-start;
      padding: 6px 14px; border-radius: 14px;
      font-size: 13px; font-weight: 700; margin-bottom: 12px;
      background: rgba(255,255,255,0.2); backdrop-filter: blur(5px);
      color: #0066ff; border: 1.2px solid #d0e2ff;
    }
    .pickup-badge.best-pick { background: linear-gradient(90deg,#ffc107,#ff8c2f); color: #fff; }
    .pickup-badge.hot-pick  { background: linear-gradient(90deg,#ff2f63,#ff8c2f); color: #fff; }
    .pickup-card h3, .pickup-card h4 {
      margin: 0 0 5px; font-weight: 800; line-height: 1.3;
    }
    .main-pick .pickup-content h3 { font-size: 2em; }
    .sub-pick  .pickup-content h4 { font-size: 1.4em; }
    .pickup-offer {
      margin: 0 0 15px; font-size: 1.1em; opacity: .9;
    }
    .pickup-btn {
      color: #fff; text-decoration: none; font-weight: 700;
      align-self: flex-start; background: rgba(255,255,255,0.25);
      padding: 8px 18px; border-radius: 20px; transition: background .2s;
    }
    .pickup-btn:hover { background: rgba(255,255,255,0.4); }
    .main-pick { grid-column: 1/2; grid-row: 1/3; min-height: 500px; }
    .sub-pick  { grid-column: 2/3; }
    @media (max-width: 900px) {
      .pickup-grid { grid-template-columns: 1fr; }
      .main-pick, .sub-pick { grid-column: 1/-1; }
      .main-pick { min-height: 400px; }
      .sub-pick  { min-height: 250px; }
    }
    @media (max-width: 600px) {
      .pickup-title { font-size: 2em; }
    }
    
 /* =============================================== */
    /* --- ì¹´ë“œ & í”Œë¦½ í•µì‹¬ ìŠ¤íƒ€ì¼ (PC ê¸°ë³¸) --- */
    /* =============================================== */

    .swiper-container {
      padding-bottom: 80px; /* í˜ì´ì§€ë„¤ì´ì…˜ ê³µê°„ */
    }

    .swiper-wrapper {
      /* 3D í”Œë¦½ì„ ìœ„í•´ ì¶”ê°€ */
      transform-style: preserve-3d;
    }

    .swiper-slide {
      /* ì¹´ë“œì˜ 3D ê³µê°„ ìœ ì§€ë¥¼ ìœ„í•´ í•„ìˆ˜ */
      transform-style: preserve-3d;
      width: 400px !important;
  max-width: 100vw;
  flex-shrink: 0;
  margin: 0 12px;
      display: flex; /* ë‚´ë¶€ ì»¨í…ì¸  ì •ë ¬ */
      justify-content: center;
    }

    .coupon-card-scene {
      width: 100%; /* ë¶€ëª¨ì¸ swiper-slide ë„ˆë¹„ë¥¼ ë”°ë¦„ */
      aspect-ratio: 2 / 3.5;
      perspective: 1200px;
      position: relative;
      max-width: 100%;
    }

    .coupon-card {
      position: relative;
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      transition: transform 0.7s cubic-bezier(.25,.8,.25,1);
      border-radius: 18px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
       /* 3D íš¨ê³¼ ì¶©ëŒì„ ë§‰ê¸° ìœ„í•´ visibleë¡œ ë³€ê²½ */
      overflow: visible;
    }

    .coupon-card-scene.is-flipped .coupon-card {
      transform: rotateY(180deg);
    }

    .card-face {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      background: var(--card-bg);
      border-radius: 18px;
      display: flex;
      flex-direction: column;
      overflow: hidden; /* ë‚´ë¶€ ì»¨í…ì¸ ê°€ ì¹´ë“œë¥¼ ë²—ì–´ë‚˜ì§€ ì•Šë„ë¡ */
    }
    .card-face--front { z-index: 2; }
    .card-face--back { transform: rotateY(180deg); }

    /* --- ì¹´ë“œ ë‚´ë¶€ ì»¨í…ì¸  ìŠ¤íƒ€ì¼ --- */
    .card-image-wrapper { width: 100%; aspect-ratio: 16/9; position: relative; flex-shrink: 0; }
    .card-image-wrapper img { position: absolute; width: 100%; height: 100%; object-fit: cover; }
    .card-content { padding: 20px; text-align: center; flex-grow: 1; display: flex; flex-direction: column; }
    .card-store-name { font-size: 20px; font-weight: bold; margin: 0 0 10px; }
    .card-offer { font-size: 32px; font-weight: 800; color: var(--danger-color); margin: 0 0 15px; }
    .card-description { font-size: 15px; color: var(--subtle-text); margin: 0 0 15px; flex-grow: 1; }
    .card-cta-button {
        background: var(--primary-color); color: #fff; padding: 15px; text-decoration: none;
        font-size: 18px; font-weight: bold; margin-top: auto; border-radius: 0 0 18px 18px;
    }
    /* ... ë’·ë©´ ìŠ¤íƒ€ì¼ ... */
    .back-actions { display: flex; gap: 10px; padding: 10px; margin-top: auto; }
    .action-btn { flex: 1; padding: 12px; border-radius: 8px; border: none; font-size: 16px; cursor: pointer;}
    .flip-back-btn { background: var(--flip-btn-bg); color: var(--flip-btn-color); }


    /* =============================================== */
    /* --- ëª¨ë°”ì¼ ë°˜ì‘í˜• ìŠ¤íƒ€ì¼ --- */
    /* =============================================== */
    @media (max-width: 767px) {
      .swiper-slide {
        /* ëª¨ë°”ì¼ì—ì„œëŠ” í™”ë©´ ë„ˆë¹„ì— ë§ì¶° ìœ ì—°í•˜ê²Œ */
        width: 90vw;
        max-width: 350px;
      }
    }
    /* ë±ƒì§€/ì €ì¥/ê±°ë¦¬ */
    .expiring-badge { position: absolute; top: -10px; right: -10px; background: var(--primary-color); color: white; padding: 10px 20px; font-size: 14px; font-weight: bold; transform: rotate(20deg); box-shadow: 0 4px 10px rgba(0,0,0,0.2); opacity: 0; transition: opacity 0.3s; pointer-events: none; z-index: 10;}
    .coupon-card-scene.is-expiring .expiring-badge { opacity: 1; }
    .save-btn { position: absolute; top: 10px; right: 10px; z-index: 5; background: rgba(0,0,0,0.4); color: white; border: none; border-radius: 50%; width: 40px; height: 40px; font-size: 20px; cursor: pointer; transition: all 0.2s; line-height: 40px; padding: 0;}
    .save-btn:hover { background: rgba(0,0,0,0.6); transform: scale(1.1);}
    .save-btn.is-saved { background: var(--save-color); color: white;}
    .distance-badge { position: absolute; top: 10px; left: 10px; z-index: 5; background: rgba(0,0,0,0.6); color: white; border-radius: 8px; padding: 5px 10px; font-size: 13px; font-weight: bold; }
    
    /* --- FILTER/SORT & VIEW SWITCHER --- */
    .controls-container {
      display:flex; flex-direction:column;
      align-items:stretch; gap:16px; margin-bottom:40px;
      position: sticky;
      top: 0;
      background: var(--card-bg);
      z-index: 100;
      padding-top: 10px;
      padding-bottom: 10px;
    }
    .filter-sort-wrapper {
      display:flex; flex-wrap:wrap;
      justify-content:center; gap:10px 16px;
      width:100% !important; flex:1 1 auto !important;
      align-self:stretch !important;
    }
    .filter-group {
      display:flex; gap:10px; flex-wrap:wrap;
      align-items:center;
    }
    .filter-group + .filter-group::before {
      content:'|'; color:#d1d9e6; margin-right:10px;
    }
    .filter-btn {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius:20px; padding:10px 20px;
      font-size:16px; font-weight:600;
      display:flex; align-items:center; gap:8px;
      cursor:pointer; transition:all .3s;
    }
    .filter-btn .count { font-size:14px; color:#888; }
    .filter-btn.active {
      background:var(--primary-color);
      color:#fff; border-color:var(--primary-color);
    }
    .filter-btn.active .count { color:rgba(255,255,255,.8); }
    body.dark-mode .filter-btn {
      background:var(--card-bg); color:#eee;
      border-color:var(--border-color);
    }
    body.dark-mode .filter-btn.active {
      background:var(--primary-color); color:#fff;
      border-color:var(--primary-color);
    }
    .sort-controls select {
      padding:10px 15px; border-radius:20px;
      border:1px solid var(--border-color);
      background:var(--card-bg); color:var(--text-color);
      font-size:16px; font-weight:600; cursor:pointer;
    }
    .view-switcher {
      display:flex; background:var(--border-color);
      border-radius:20px; padding:4px; align-self:center;
    }
    .view-btn {
      border:none; background:transparent;
      padding:6px 16px; border-radius:16px;
      font-size:16px; font-weight:600; cursor:pointer;
      display:flex; align-items:center; gap:8px;
      color: var(--subtle-text);
      transition: all .3s;
    }
    .view-btn.active {
      background:var(--card-bg);
      color:var(--primary-color);
      box-shadow:0 2px 5px rgba(0,0,0,0.1);
    }
    
    /* --- SWIPER STYLES --- */
    .swiper {
      position:relative;
      overflow: visible !important;
      padding-left:20px; padding-right:20px;
      padding-bottom:80px !important;
    }
    .swiper-button-prev, .swiper-button-next {
      position:absolute; top:50%; transform:translateY(-50%);
      z-index:20; width:36px; height:36px;
      background:rgba(255,255,255,.9);
      border-radius:50%; display:flex;
      align-items:center; justify-content:center;
      color:var(--dark-blue);
      box-shadow:0 2px 6px rgba(0,0,0,.1);
    }
    .swiper-button-prev { left:8px; }
    .swiper-button-next { right:8px; }
    
    
    /* --- LIST TITLE --- */
    .list-title-wrapper { text-align:center; margin-bottom:30px; }
    .list-title {
      display:inline-block; padding:12px 30px;
      background:var(--card-bg);
      color:var(--dark-blue);
      font-size:1.8em; font-weight:800;
      border-radius:30px;
      box-shadow:0 4px 15px rgba(0,0,0,.07);
      letter-spacing:.03em;
    }
    body.dark-mode .list-title { color:var(--dark-blue); }
    @media(max-width:600px){ .list-title { font-size:1.5em; } }
    
    /* --- EMPTY STATE & TOAST --- */
    .empty-state {
      width:100%; text-align:center; padding:80px 20px;
      background:var(--card-bg); border-radius:15px;
      margin-top:20px; display:none;
    }
    .empty-state.show { display:block; }
    .empty-state .fa-ghost {
      font-size:48px; margin-bottom:20px; color:#999;
    }
    .empty-state h3 { font-size:24px; color:var(--text-color); }
    .empty-state p  { font-size:16px; color:var(--subtle-text); margin-bottom:25px; }
    .empty-state .reset-btn {
      background:var(--primary-color); color:#fff;
      border:none; border-radius:20px;
      padding:10px 25px; font-size:16px;
      cursor:pointer; 
    }
    .toast-notification {
      position:fixed; bottom:20px; right:20px;
      background:var(--dark-blue); color:#fff;
      padding:15px 25px; border-radius:8px;
      z-index:1001; opacity:0;
      transform: translateY(20px);
      transition: opacity .3s, transform .3s;
      display:flex; align-items:center; gap:10px;
    }
    .toast-notification.show {
      opacity:1; transform: translateY(0);
    }
    
    /* --- THEMED FEATURE (ë¨¸ìŠ¤íŠ¸ë°”ì´) SECTION --- */
    .themed-feature-section {
      max-width:1200px; margin:40px auto; padding:40px 20px;
      background:var(--card-bg); border-radius:20px;
    }
    body.dark-mode .themed-feature-section { background:#272e3a; }
    .themed-title { text-align:center; margin-bottom:30px; }
    .themed-title h4 {
      font-family:'Noto Serif JP',serif;
      font-size:2em; font-weight:700; color:var(--dark-blue);
      margin:0 0 10px;
    }
    .themed-title h4 span {
      font-size:0.6em; font-weight:700; color:#fff;
      background:var(--danger-color); padding:4px 10px; border-radius:12px;
      margin-right:10px; vertical-align:middle;
    }
    .themed-title p { font-size:1.1em; color:var(--subtle-text); }
    .themed-article-link {
      display:inline-block; margin-top:15px; font-size:1em;
      font-weight:700; color:var(--primary-color);
      text-decoration:none;
      background:var(--tag-bg); padding:8px 18px;
      border:1px solid var(--tag-border); border-radius:20px;
      transition:all .2s;
    }
    .themed-article-link:hover {
      background:var(--primary-color); color:#fff;
      border-color:var(--primary-color);
    }
    .themed-grid {
      display:grid;
      grid-template-columns: repeat(auto-fit,minmax(250px,1fr));
      gap:20px;
    }
    .themed-card {
      display:block; position:relative; overflow:hidden;
      border-radius:15px; box-shadow:0 4px 15px rgba(0,0,0,0.05);
      transition:transform .3s,box-shadow .3s;
      text-decoration:none;
    }
    .themed-card:hover {
      transform:translateY(-5px);
      box-shadow:0 8px 25px rgba(0,0,0,0.1);
    }
    .themed-card img {
      width:100%; height:200px; object-fit:cover;
    }
    .themed-card-content {
      position:absolute; bottom:0; left:0; right:0;
      padding:15px; color:#fff;
      background:linear-gradient(to top,rgba(0,0,0,0.7),transparent);
    }
    .themed-card-content h5 {
      margin:0 0 2px; font-size:1.2em; font-weight:700;
    }
    .themed-card-content p {
      margin:0; font-size:0.9em; opacity:.9;
    }
    
    /* --- BUTTON ACTIVE EFFECT --- */
    button { position: relative; overflow: hidden; }
    button:active::after {
      transform: translate(-50%, -50%) scale(1);
      opacity: 1;
      transition: transform .2s, opacity .4s;
    }
    @keyframes badgeBounce {
      0%, 100% { transform: rotate(45deg) translateY(0); }
      50%      { transform: rotate(45deg) translateY(-6px); }
    }
    
    /* --- FOOTER --- */
    .site-footer {
      background: var(--dark-blue); color:rgba(255,255,255,0.7);
      padding:50px 20px;
    }
    .footer-content { max-width:1200px; margin:0 auto; text-align:center; }
    .footer-logo img {
      filter:brightness(0) invert(1) opacity(.7); height:30px;
    }
    .footer-about {
      max-width:600px; margin:20px auto; line-height:1.6;
    }
    .footer-links {
      margin:20px 0; display:flex; justify-content:center;
      gap:20px; flex-wrap:wrap; list-style:none; padding:0;
    }
    .footer-links a {
      color:rgba(255,255,255,.7); font-size:14px;
    }
    .footer-links a:hover { color:#fff; }
    .footer-copyright {
      font-size:13px; margin-top:30px;
      border-top:1px solid rgba(255,255,255,.1);
      padding-top:30px;
    }

    </style>
    


</head>
<body>
    <header class="site-header-hero">
        <div class="nav-row">
            <a href="#" class="nav-logo-link">
              <img src="https://japankuru.com/gld-kanri/data/themes/japankuru/assets/images/logo.svg" alt="Japankuru Logo">
            </a>
            <div class="theme-switcher">
              <i class="fa-solid fa-sun"></i>
              <div class="theme-toggle"></div>
              <i class="fa-solid fa-moon"></i>
            </div>
          </div>

     
  <div class="hero-content">
    <h1>JAPANKURU <b>Special Coupon</b></h1>
    <div class="hero-search-form">
      <input type="search" id="coupon-search" placeholder="åº—åã€åœ°åŸŸã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢ (ä¾‹: æ–°å®¿ã€ãƒ©ãƒ¼ãƒ¡ãƒ³)">

<i class="fa-solid fa-xmark clear-btn" onclick="document.getElementById('coupon-search').value=''; updateView();"></i>
      <i class="fa-solid fa-magnifying-glass search-icon"></i>
    </div>
    <div class="hero-sub">
      <span>è¨ªæ—¥è¦³å…‰ã®æœ€æ–°ã‚¯ãƒ¼ãƒãƒ³æƒ…å ±ã¾ã¨ã‚ <span class="sparkle">âœ¨</span></span>
    </div>
  </div>
</header>

      
    <div class="list-title-wrapper">
      <h2 class="list-title">ğŸŸï¸ å…¨ã‚¯ãƒ¼ãƒãƒ³ãƒªã‚¹ãƒˆã‹ã‚‰æ¢ã™</h2>
    </div>
    <div class="interaction-notice">ğŸ’¡ <b>ãƒ’ãƒ³ãƒˆ:</b> å„ã‚«ãƒ¼ãƒ‰ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€è£é¢ã®è©³ç´°æƒ…å ±ã¨Googleãƒãƒƒãƒ—ãŒç¢ºèªã§ãã¾ã™ï¼</div>
      <!-- [NEW] ì¡°ê±´ë°”(í•„í„°/ê²€ìƒ‰/ì •ë ¬ ìƒíƒœí‘œì‹œ) -->
      <div class="cond-bar" id="cond-bar" style="display:none;"></div>
      <div class="controls-container">
        <div class="view-switcher">
          <button class="view-btn active" data-view="list"><i class="fa-solid fa-list"></i> ãƒªã‚¹ãƒˆ</button>
          <button class="view-btn" data-view="map"><i class="fa-solid fa-map-location-dot"></i> åœ°å›³</button>
        </div>
      
        <div class="filter-sort-wrapper">
          <div class="filter-group">
            <button class="filter-btn" data-filter="nearby"><i class="fa-solid fa-location-arrow"></i> å‘¨è¾º</button>
            <button class="filter-btn" data-filter="saved"><i class="fa-solid fa-star"></i> ä¿å­˜æ¸ˆã¿ <span class="count"></span></button>
          </div>
          <div class="filter-group">
            <button class="filter-btn active" data-filter="all"><i class="fa-solid fa-border-all"></i> ã™ã¹ã¦è¡¨ç¤º <span class="count"></span></button>
            <button class="filter-btn" data-filter="electronics"><i class="fa-solid fa-laptop"></i> å®¶é›» <span class="count"></span></button>
            <button class="filter-btn" data-filter="fashion"><i class="fa-solid fa-shirt"></i> ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ <span class="count"></span></button>
            <button class="filter-btn" data-filter="dining"><i class="fa-solid fa-utensils"></i> ã‚°ãƒ«ãƒ¡ <span class="count"></span></button>
            <button class="filter-btn" data-filter="transport"><i class="fa-solid fa-train-subway"></i> äº¤é€š <span class="count"></span></button>
          </div>
          <div class="sort-controls">
            <select id="sort-select">
              <option value="default">æ¨™æº–ã®ä¸¦ã³é †</option>
              <option value="expiry">æœ‰åŠ¹æœŸé™ãŒè¿‘ã„é †</option>
              <option value="discount">å‰²å¼•ç‡ã®é«˜ã„é †</option>
            </select>
          </div>
        </div>
      </div>
      <div class="empty-state">
        <i class="fa-solid fa-ghost"></i>
        <h3>è©²å½“ã™ã‚‹ã‚¯ãƒ¼ãƒãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</h3>
        <p>ä»–ã®æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚„æ¡ä»¶ã‚’ãŠè©¦ã—ãã ã•ã„ã€‚</p>
        <button class="reset-btn">ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼åˆæœŸåŒ–</button>
      </div>
      <div id="map-container" style="display: none;"></div>
    <div class="swiper">
      <div class="swiper-wrapper">
        <div class="swiper-slide" data-original-order="1">
          <div class="coupon-card-scene" data-coupon-id="1" data-category="electronics" data-expiry="2025-12-31" data-lat="35.6908" data-lon="139.7028">
            <div class="expiring-badge">é–“ã‚‚ãªãçµ‚äº†</div>
            <div class="card-category-icon"></div>
            <div class="distance-badge" style="display: none;"></div>
            <button class="save-btn"><i class="fa-regular fa-star"></i></button>
            <div class="coupon-card">
              <div class="card-face card-face--front">
                <div class="card-image-wrapper"><img src="https://japankuru.com/gld-kanri/data/uploads/2023/11/kojima%E8%8B%B1%E8%AA%9E%E7%89%88%E4%BC%81%E6%A5%AD%E6%9C%89_kojima_EN_B-2.jpg" alt="KOJIMA Coupon"></div>
                <div class="card-content">
                  <h3 class="card-store-name">ã‚³ã‚¸ãƒ x ãƒ“ãƒƒã‚¯ã‚«ãƒ¡ãƒ©</h3>
                  <p class="card-offer">æœ€å¤§ 17% OFF</p>
                  <p class="card-description">å…ç¨10% + è¿½åŠ 7%å‰²å¼•ï¼æœ€æ–°ã®é›»å­è£½å“ã‚’å®‰ãæ‰‹ã«å…¥ã‚Œã‚ˆã†ã€‚</p>
                  <div class="card-tags"><span class="tag">#æ–°å®¿</span> <span class="tag">#å…ç¨</span> <span class="tag">#å®¶é›»</span></div>
                  <p class="card-expiry">ğŸ•’ æœ‰åŠ¹æœŸé–“: 2025.12.31</p>
                </div>
                <div class="card-cta-button">âœ‚ï¸ ã‚¯ãƒ¼ãƒãƒ³è£é¢ã‚’è¦‹ã‚‹</div>
              </div>
              <div class="card-face card-face--back">
                <div class="back-qr-code"><img src="https://api.qrserver.com/v1/create-qr-code/?size=120x120&data=JK-BIC2025" alt="QR Code"></div>
                <div class="back-map-wrapper"><iframe loading="lazy" src="https://maps.app.goo.gl/wJkL8c2q8BwH8a8T92"></iframe></div>
                <div class="back-section">
                  <h4>é–¢é€£æƒ…å ±</h4>
                  <ul class="back-info-list">
                    <li><span>ğŸ“ ä½æ‰€: æ±äº¬éƒ½æ–°å®¿åŒºæ–°å®¿3-29-1</span><a href="https://maps.app.goo.gl/wJkL8c2q8BwH8a8T93" target="_blank" rel="noopener noreferrer">çµŒè·¯æ¡ˆå†…</a></li>
                    <li><span>â° å–¶æ¥­æ™‚é–“: æ¯æ—¥ 10:00 - 22:00</span></li>
                    <li><span>âœ¨ ãƒ’ãƒ³ãƒˆ: 8éšã®ã‚²ãƒ¼ãƒ ã‚³ãƒ¼ãƒŠãƒ¼ã¯äººæ°—ï¼</span></li>
                  </ul>
                </div>
                <div class="details-link-wrapper"><a href="https://www.japankuru.com/en/shopping/e4200/" class="details-link" target="_blank">è©³ç´°æƒ…å ±ã‚’è¦‹ã‚‹ â†’</a></div>
                <div class="back-actions">
                  
                  <button class="action-btn flip-back-btn"><i class="fa-solid fa-rotate-left"></i> è¡¨é¢ã¸</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="swiper-slide" data-original-order="2">
          <div class="coupon-card-scene" data-coupon-id="2" data-category="fashion" data-expiry="2025-07-30" data-lat="35.6603" data-lon="139.6983">
             <div class="expiring-badge">é–“ã‚‚ãªãçµ‚äº†</div>
            <div class="card-category-icon"></div>
            <div class="distance-badge" style="display: none;"></div>
            <button class="save-btn"><i class="fa-regular fa-star"></i></button>
            <div class="coupon-card">
              <div class="card-face card-face--front">
                <div class="card-image-wrapper"><img src="https://japankuru.com/gld-kanri/data/uploads/2024/06/japankuru_1800-1200-1536x1024.jpg" alt="JINS Coupon"></div>
                <div class="card-content">
                  <h3 class="card-store-name">JINS</h3>
                  <p class="card-offer">10% OFF</p>
                  <p class="card-description">æ—¥æœ¬ã®ä»£è¡¨çš„ãªãƒ¡ã‚¬ãƒãƒ–ãƒ©ãƒ³ãƒ‰JINSï¼ãŠã—ã‚ƒã‚Œãªãƒ¡ã‚¬ãƒã‚’å…ç¨+å‰²å¼•ã§ã€‚</p>
                  <div class="card-tags"><span class="tag">#æ¸‹è°·</span> <span class="tag">#ãƒ¡ã‚¬ãƒ</span></div>
                  <p class="card-expiry">ğŸ•’ æœ‰åŠ¹æœŸé–“: 2025.07.30</p>
                </div>
                <div class="card-cta-button">âœ‚ï¸ ã‚¯ãƒ¼ãƒãƒ³è£é¢ã‚’è¦‹ã‚‹</div>
              </div>
              <div class="card-face card-face--back">
                <div class="back-qr-code"><img src="https://api.qrserver.com/v1/create-qr-code/?size=120x120&data=JK-JINS2025" alt="QR Code"></div>
                <div class="back-map-wrapper"><iframe loading="lazy" src="https://maps.app.goo.gl/wJkL8c2q8BwH8a8T94"></iframe></div>
                <div class="back-section">
                  <h4>é–¢é€£æƒ…å ±</h4>
                  <ul class="back-info-list">
                    <li><span>ğŸ“ ä½æ‰€: æ±äº¬éƒ½æ¸‹è°·åŒºå®‡ç”°å·ç”º31-1</span><a href="https://maps.app.goo.gl/wJkL8c2q8BwH8a8T95" target="_blank" rel="noopener noreferrer">çµŒè·¯æ¡ˆå†…</a></li>
                    <li><span>â° å–¶æ¥­æ™‚é–“: æ¯æ—¥ 11:00 - 21:00</span></li>
                    <li><span>âœ¨ ãƒ’ãƒ³ãƒˆ: æœ€çŸ­30åˆ†ã§å®Œæˆï¼</span></li>
                  </ul>
                </div>
                <div class="details-link-wrapper"><a href="#" class="details-link" target="_blank">è©³ç´°æƒ…å ±ã‚’è¦‹ã‚‹ â†’</a></div>
                <div class="back-actions">
                  <button type="button" class="action-btn share-btn"><i class="fa-solid fa-share-nodes"></i> å…±æœ‰</button>
                  <button class="action-btn flip-back-btn"><i class="fa-solid fa-rotate-left"></i> è¡¨é¢ã¸</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="swiper-slide" data-original-order="3">
            <div class="coupon-card-scene" data-coupon-id="3" data-category="fashion" data-expiry="2025-09-30" data-lat="35.6705" data-lon="139.7073">
                <div class="expiring-badge">é–“ã‚‚ãªãçµ‚äº†</div>
                <div class="card-category-icon"></div>
                <div class="distance-badge" style="display: none;"></div>
                <button class="save-btn"><i class="fa-regular fa-star"></i></button>
                <div class="coupon-card">
                    <div class="card-face card-face--front">
                        <div class="card-image-wrapper"><img src="https://img.japankuru.com/prg_img/img/img2024011517461371466800.jpg" alt="BEAMS Coupon"></div>
                        <div class="card-content">
                            <h3 class="card-store-name">BEAMS JAPAN</h3>
                            <p class="card-offer">5% è¿½åŠ å‰²å¼•</p>
                            <p class="card-description">æ—¥æœ¬ã®æœ€æ–°ãƒˆãƒ¬ãƒ³ãƒ‰ã‚’ç™ºä¿¡ã™ã‚‹ã‚»ãƒ¬ã‚¯ãƒˆã‚·ãƒ§ãƒƒãƒ—BEAMSã§ç‰¹åˆ¥ãªã‚¢ã‚¤ãƒ†ãƒ ã‚’ã€‚</p>
                            <div class="card-tags"><span class="tag">#åŸå®¿</span><span class="tag">#ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³</span></div>
                            <p class="card-expiry">ğŸ•’ æœ‰åŠ¹æœŸé–“: 2025.09.30</p>
                        </div>
                        <div class="card-cta-button">âœ‚ï¸ ã‚¯ãƒ¼ãƒãƒ³è£é¢ã‚’è¦‹ã‚‹</div>
                    </div>
                    <div class="card-face card-face--back">
                       <div class="back-qr-code"><img src="https://api.qrserver.com/v1/create-qr-code/?size=120x120&data=JK-BEAMS25" alt="QR Code"></div>
                        <div class="back-map-wrapper"><iframe loading="lazy" src="https://maps.app.goo.gl/wJkL8c2q8BwH8a8T96"></iframe></div>
                        <div class="back-section">
                          <h4>é–¢é€£æƒ…å ±</h4>
                          <ul class="back-info-list">
                            <li><span>ğŸ“ ä½æ‰€: æ±äº¬éƒ½æ¸‹è°·åŒºç¥å®®å‰3-24-7</span><a href="https://maps.app.goo.gl/wJkL8c2q8BwH8a8T97" target="_blank" rel="noopener noreferrer">çµŒè·¯æ¡ˆå†…</a></li>
                            <li><span>â° å–¶æ¥­æ™‚é–“: æ¯æ—¥ 11:00 - 20:00</span></li>
                            <li><span>âœ¨ ãƒ’ãƒ³ãƒˆ: æ—¥æœ¬é™å®šã‚³ãƒ©ãƒœå•†å“ã‚’æ¢ã—ã¦ã¿ã¦ã€‚</span></li>
                          </ul>
                        </div>
                        <div class="details-link-wrapper"><a href="#" class="details-link" target="_blank">è©³ç´°æƒ…å ±ã‚’è¦‹ã‚‹ â†’</a></div>
                        <div class="back-actions">
                            <button class="action-btn share-btn"><i class="fa-solid fa-share-nodes"></i> å…±æœ‰</button>
                            <button class="action-btn flip-back-btn"><i class="fa-solid fa-rotate-left"></i> è¡¨é¢ã¸</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="swiper-slide" data-original-order="4">
            <div class="coupon-card-scene" data-coupon-id="4" data-category="dining" data-expiry="2026-03-31" data-lat="35.6970" data-lon="139.7001">
                <div class="expiring-badge">é–“ã‚‚ãªãçµ‚äº†</div>
                <div class="card-category-icon"></div>
                <div class="distance-badge" style="display: none;"></div>
                <button class="save-btn"><i class="fa-regular fa-star"></i></button>
                <div class="coupon-card">
                    <div class="card-face card-face--front">
                        <div class="card-image-wrapper"><img src="https://japankuru.com/gld-kanri/data/uploads/2024/06/%E4%BE%8D%E3%82%AF%E3%83%BC%E3%83%9D%E3%83%B3c-2_0_0-1536x864.jpeg" alt="Samurai Restaurant Coupon"></div>
                        <div class="card-content">
                            <h3 class="card-store-name">ã‚µãƒ ãƒ©ã‚¤ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³</h3>
                            <p class="card-offer">ãƒ‰ãƒªãƒ³ã‚¯1æ¯ç„¡æ–™</p>
                            <p class="card-description">è¯éº—ãªã‚·ãƒ§ãƒ¼ã¨å…±ã«æ¥½ã—ã‚€ç‰¹åˆ¥ãªé£Ÿäº‹ï¼ã‚¯ãƒ¼ãƒãƒ³æç¤ºã§ãƒ‰ãƒªãƒ³ã‚¯ã‚’ã‚²ãƒƒãƒˆã€‚</p>
                            <div class="card-tags"><span class="tag">#æ–°å®¿</span><span class="tag">#ã‚¨ãƒ³ã‚¿ãƒ¡</span></div>
                            <p class="card-expiry">ğŸ•’ æœ‰åŠ¹æœŸé–“: 2026.03.31</p>
                        </div>
                        <div class="card-cta-button">âœ‚ï¸ ã‚¯ãƒ¼ãƒãƒ³è£é¢ã‚’è¦‹ã‚‹</div>
                    </div>
                    <div class="card-face card-face--back">
                       <div class="back-qr-code"><img src="https://api.qrserver.com/v1/create-qr-code/?size=120x120&data=JK-SAMURAI" alt="QR Code"></div>
                        <div class="back-map-wrapper"><iframe loading="lazy" src="https://maps.app.goo.gl/wJkL8c2q8BwH8a8T98"></iframe></div>
                        <div class="back-section">
                            <h4>é–¢é€£æƒ…å ±</h4>
                            <ul class="back-info-list">
                                <li><span>ğŸ“ ä½æ‰€: æ±äº¬éƒ½æ–°å®¿åŒºæ­Œèˆä¼ç”º2-45-8</span><a href="https://maps.app.goo.gl/wJkL8c2q8BwH8a8T99" target="_blank" rel="noopener noreferrer">çµŒè·¯æ¡ˆå†…</a></li>
                                <li><span>â° å–¶æ¥­æ™‚é–“: æ¯æ—¥ 18:00 - 23:30</span></li>
                                <li><span>âœ¨ ãƒ’ãƒ³ãƒˆ: å…¬æ¼”æ™‚é–“ã®30åˆ†å‰ã«åˆ°ç€ãŒãŠã™ã™ã‚ï¼</span></li>
                            </ul>
                        </div>
                        <div class="details-link-wrapper"><a href="#" class="details-link" target="_blank">è©³ç´°æƒ…å ±ã‚’è¦‹ã‚‹ â†’</a></div>
                        <div class="back-actions">
                            <button class="action-btn share-btn"><i class="fa-solid fa-share-nodes"></i> å…±æœ‰</button>
                            <button class="action-btn flip-back-btn"><i class="fa-solid fa-rotate-left"></i> è¡¨é¢ã¸</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="swiper-slide" data-original-order="5">
            <div class="coupon-card-scene" data-coupon-id="5" data-category="transport" data-expiry="9999-12-31" data-lat="35.6580" data-lon="139.7016">
                <div class="expiring-badge">é–“ã‚‚ãªãçµ‚äº†</div>
                <div class="card-category-icon"></div>
                <div class="distance-badge" style="display: none;"></div>
                <button class="save-btn"><i class="fa-regular fa-star"></i></button>
                <div class="coupon-card">
                    <div class="card-face card-face--front">
                        <div class="card-image-wrapper"><img src="https://japankuru.com/gld-kanri/data/uploads/2025/03/tokyu-cover-16-9-1-1536x864.png" alt="Tokyu Line Coupon"></div>
                        <div class="card-content">
                            <h3 class="card-store-name">æ±æ€¥ç·š</h3>
                            <p class="card-offer">1æ—¥ä¹—è»Šåˆ¸</p>
                            <p class="card-description">æ±äº¬æ—…è¡Œã®å¿…é ˆã‚¢ã‚¤ãƒ†ãƒ ï¼æ¸‹è°·ã€è‡ªç”±ãŒä¸˜ãªã©ã‚’å·¡ã‚‹æ±æ€¥ç·šã®1æ—¥ä¹—è»Šåˆ¸ã€‚</p>
                            <div class="card-tags"><span class="tag">#æ¸‹è°·</span><span class="tag">#äº¤é€š</span><span class="tag">#ä¹—ã‚Šæ”¾é¡Œ</span></div>
                            <p class="card-expiry">âœ… å¸¸æ™‚ã‚¤ãƒ™ãƒ³ãƒˆ</p>
                        </div>
                        <div class="card-cta-button">âœ‚ï¸ ã‚¯ãƒ¼ãƒãƒ³è£é¢ã‚’è¦‹ã‚‹</div>
                    </div>
                    <div class="card-face card-face--back">
                        <div class="back-qr-code"><img src="https://api.qrserver.com/v1/create-qr-code/?size=120x120&data=JK-TOKYU" alt="QR Code"></div>
                        <div class="back-map-wrapper"><iframe loading="lazy" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3241.838384232375!2d139.6957246152583!3d35.66033498019999!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x60188ca883442169%3A0xb3e0a1b3a1a396b2!2sJINS%20Shibuya%20Store!5e0!3m2!1sen!2sjp!4v1689745501103!5m2!1sen!2sjp0"></iframe></div>
                        <div class="back-section">
                            <h4>é–¢é€£æƒ…å ±</h4>
                            <ul class="back-info-list">
                                <li><span>ğŸ“ äº¤æ›å ´æ‰€: æ¸‹è°·é§…ãªã©æ±æ€¥ç·šã®ä¸»è¦é§…çª“å£</span></li>
                                <li><span>â° åˆ©ç”¨æ™‚é–“: å§‹ç™ºã‹ã‚‰çµ‚é›»ã¾ã§</span></li>
                                <li><span>âœ¨ ãƒ’ãƒ³ãƒˆ: ä¸‹åŒ—æ²¢ã€è‡ªç”±ãŒä¸˜ã¸ã®æ—…è¡Œæ™‚ã«ç‰¹ã«ä¾¿åˆ©ï¼</span></li>
                            </ul>
                        </div>
                        <div class="details-link-wrapper"><a href="#" class="details-link" target="_blank">è©³ç´°æƒ…å ±ã‚’è¦‹ã‚‹ â†’</a></div>
                        <div class="back-actions">
                            <button class="action-btn share-btn"><i class="fa-solid fa-share-nodes"></i> å…±æœ‰</button>
                            <button class="action-btn flip-back-btn"><i class="fa-solid fa-rotate-left"></i> è¡¨é¢ã¸</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="swiper-slide" data-original-order="6">
            <div class="coupon-card-scene" data-coupon-id="6" data-category="electronics" data-expiry="2025-11-30" data-lat="35.6984" data-lon="139.7745">
                <div class="expiring-badge">é–“ã‚‚ãªãçµ‚äº†</div>
                <div class="card-category-icon"></div>
                <div class="distance-badge" style="display: none;"></div>
                <button class="save-btn"><i class="fa-regular fa-star"></i></button>
                <div class="coupon-card">
                    <div class="card-face card-face--front">
                        <div class="card-image-wrapper"><img src="https://img.japankuru.com/prg_img/thumbnail1/img2023112417190332724100.png" alt="Yodobashi Camera Coupon"></div>
                        <div class="card-content">
                            <h3 class="card-store-name">ãƒ¨ãƒ‰ãƒã‚·ã‚«ãƒ¡ãƒ©</h3>
                            <p class="card-offer">æœ€å¤§ 15% OFF</p>
                            <p class="card-description">å…ç¨10% + VISAã‚«ãƒ¼ãƒ‰æ±ºæ¸ˆã§5%è¿½åŠ å‰²å¼•ï¼ã‚«ãƒ¡ãƒ©ã€å®¶é›»ã€ã‚²ãƒ¼ãƒ ã¾ã§ã€‚</p>
                            <div class="card-tags"><span class="tag">#ç§‹è‘‰åŸ</span><span class="tag">#å…ç¨</span><span class="tag">#ã‚²ãƒ¼ãƒ </span></div>
                            <p class="card-expiry">ğŸ•’ æœ‰åŠ¹æœŸé–“: 2025.11.30</p>
                        </div>
                        <div class="card-cta-button">âœ‚ï¸ ã‚¯ãƒ¼ãƒãƒ³è£é¢ã‚’è¦‹ã‚‹</div>
                    </div>
                    <div class="card-face card-face--back">
                        <div class="back-qr-code"><img src="https://api.qrserver.com/v1/create-qr-code/?size=120x120&data=JK-Yodobashi" alt="QR Code"></div>
                        <div class="back-map-wrapper"><iframe loading="lazy" src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3241.838384232375!2d139.6957246152583!3d35.66033498019999!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x60188ca883442169%3A0xb3e0a1b3a1a396b2!2sJINS%20Shibuya%20Store!5e0!3m2!1sen!2sjp!4v1689745501103!5m2!1sen!2sjp1"></iframe></div>
                        <div class="back-section">
                          <h4>é–¢é€£æƒ…å ±</h4>
                          <ul class="back-info-list">
                            <li><span>ğŸ“ ä½æ‰€: æ±äº¬éƒ½åƒä»£ç”°åŒºç¥ç”°èŠ±å²¡ç”º1-1</span><a href="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3241.838384232375!2d139.6957246152583!3d35.66033498019999!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x60188ca883442169%3A0xb3e0a1b3a1a396b2!2sJINS%20Shibuya%20Store!5e0!3m2!1sen!2sjp!4v1689745501103!5m2!1sen!2sjp2" target="_blank" rel="noopener noreferrer">çµŒè·¯æ¡ˆå†…</a></li>
                            <li><span>â° å–¶æ¥­æ™‚é–“: æ¯æ—¥ 09:30 - 22:00</span></li>
                            <li><span>âœ¨ ãƒ’ãƒ³ãƒˆ: ãƒ•ã‚£ã‚®ãƒ¥ã‚¢ã‚„ã‚¢ãƒ‹ãƒ¡ã‚°ãƒƒã‚ºã¯6éšã«é›†çµï¼</span></li>
                          </ul>
                        </div>
                        <div class="details-link-wrapper"><a href="#" class="details-link" target="_blank">è©³ç´°æƒ…å ±ã‚’è¦‹ã‚‹ â†’</a></div>
                        <div class="back-actions">
                            <button class="action-btn share-btn"><i class="fa-solid fa-share-nodes"></i> å…±æœ‰</button>
                            <button class="action-btn flip-back-btn"><i class="fa-solid fa-rotate-left"></i> è¡¨é¢ã¸</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
      </div>
      <div class="swiper-pagination"></div>
      <div class="swiper-button-prev"></div>
      <div class="swiper-button-next"></div>
    </div>
  </div>

  <section class="pickup-special-section">
    <div class="pickup-title-wrapper">
      <h2 class="pickup-title">ğŸ”¥ Editor's Pick / ä»Šé€±ã®ç‰¹åˆ¥ã‚»ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³</h2>
      <p class="pickup-subtitle">ã‚¸ãƒ£ãƒ‘ãƒ³ã‚°ãƒ«ç·¨é›†éƒ¨ãŒå³é¸ã—ãŸã€ä»Šé€±æœ€é«˜ã®ã‚¯ãƒ¼ãƒãƒ³ã‚’ãŠè¦‹é€ƒã—ãªãï¼</p>
    </div>
    <div class="pickup-grid">
      <div class="pickup-card main-pick">
        <img src="https://japankuru.com/gld-kanri/data/uploads/2023/11/kojima%E8%8B%B1%E8%AA%9E%E7%89%88%E4%BC%81%E6%A5%AD%E6%9C%89_kojima_EN_B-2.jpg" alt="ãƒ¡ã‚¤ãƒ³æ¨è–¦ã‚¯ãƒ¼ãƒãƒ³ã‚¤ãƒ¡ãƒ¼ã‚¸" loading="eager" 
        fetchpriority="high">
        <div class="pickup-overlay"></div>
        <div class="pickup-content">
          <span class="pickup-badge best-pick">ğŸŒŸ BEST PICK</span>
          <h3>ã‚³ã‚¸ãƒ x ãƒ“ãƒƒã‚¯ã‚«ãƒ¡ãƒ©</h3>
          <p class="pickup-offer">ç¨æŠœä¾¡æ ¼ã‹ã‚‰æœ€å¤§7%è¿½åŠ å‰²å¼•</p>
          <div class="editor-comment">
            <i class="fa-solid fa-pen-nib"></i>
            <span><b>Editor's Tip:</b> æœ€æ–°ã®ãƒã‚¤ã‚ºã‚­ãƒ£ãƒ³ã‚»ãƒªãƒ³ã‚°ãƒ˜ãƒƒãƒ‰ãƒ›ãƒ³ã¯ã€æ—¥æœ¬ã®åº—èˆ—ãŒä¸–ç•Œã§æœ€ã‚‚æ—©ãã€ãã—ã¦å®‰ãæ‰‹ã«å…¥ã‚‹ãƒãƒ£ãƒ³ã‚¹ã§ã™ï¼</span>
          </div>
          <a href="#coupon-1" class="pickup-btn">ä»Šã™ããƒã‚§ãƒƒã‚¯ &rarr;</a>
        </div>
      </div>
  
      <div class="pickup-card sub-pick">
        <img src="https://japankuru.com/gld-kanri/data/uploads/2024/06/%E4%BE%8D%E3%82%AF%E3%83%BC%E3%83%9D%E3%83%B3c-2_0_0-1536x864.jpeg" alt="ã‚µãƒ–æ¨è–¦1ã‚¤ãƒ¡ãƒ¼ã‚¸">
        <div class="pickup-overlay"></div>
        <div class="pickup-content">
          <span class="pickup-badge">ğŸ”¥ HOT</span>
          <h4>ã‚µãƒ ãƒ©ã‚¤ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³</h4>
          <p class="pickup-offer">ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ‰ãƒªãƒ³ã‚¯1æ¯ç„¡æ–™</p>
          <a href="#coupon-4" class="pickup-btn">è©³ã—ãè¦‹ã‚‹ &rarr;</a>
        </div>
      </div>
  
      <div class="pickup-card sub-pick">
        <img src="https://japankuru.com/gld-kanri/data/uploads/2024/06/japankuru_1800-1200-1536x1024.jpg" alt="ã‚µãƒ–æ¨è–¦2ã‚¤ãƒ¡ãƒ¼ã‚¸">
        <div class="pickup-overlay"></div>
        <div class="pickup-content">
          <span class="pickup-badge">âœ… MUST-HAVE</span>
          <h4>JINS ãƒ¡ã‚¬ãƒ</h4>
          <p class="pickup-offer">å…ç¨ + 10%è¿½åŠ å‰²å¼•</p>
          <a href="#coupon-2" class="pickup-btn">è©³ã—ãè¦‹ã‚‹ &rarr;</a>
        </div>
      </div>
    </div>
  </section>


  <section class="themed-feature-section">
    <div class="themed-title">
      <h4><span>SPECIAL</span>å¤ã®çµ‚ã‚ã‚Šã®ãƒã‚¹ãƒˆãƒã‚¤</h4>
      <p>ç§‹ã®ãƒˆãƒ¬ãƒ³ãƒ‰ã‚’å…ˆå–ã‚Šã™ã‚‹ãƒ•ã‚¡ãƒƒã‚·ãƒ§ãƒ³ãƒ»ãƒ“ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ¼ã‚¢ã‚¤ãƒ†ãƒ ã‚’ãƒã‚§ãƒƒã‚¯ï¼</p>
      <a href="/articles/summer-end-must-buy" class="themed-article-link">ç‰¹é›†è¨˜äº‹å…¨ä½“ã‚’è¦‹ã‚‹ &rarr;</a>
    </div>
    <div class="themed-grid">
      <a href="#coupon-id-for-item1" class="themed-card">
        <img src="https://japankuru.com/gld-kanri/data/uploads/2025/06/Canmake_Summer_Thumbnail02-1536x864.jpg" alt="ì•„ì´í…œ 1">
        <div class="themed-card-content">
          <h5>ç§‹è‰²ã‚³ã‚¹ãƒ¡</h5>
          <p>ä»Šã ã‘ã®é™å®šã‚«ãƒ©ãƒ¼</p>
        </div>
      </a>
      <a href="#coupon-id-for-item2" class="themed-card">
        <img src="https://japankuru.com/gld-kanri/data/uploads/2025/05/Vivienne-Westwood_CC32-800x533.jpg" alt="ì•„ì´í…œ 2">
        <div class="themed-card-content">
          <h5>è»½é‡ã‚¸ãƒ£ã‚±ãƒƒãƒˆ</h5>
          <p>æœæ™©ã®æ°—æ¸©å·®ã«</p>
        </div>
      </a>
      <a href="https://www.japankuru.com/ko/shopping/108691/" class="themed-card">
        <img src="https://japankuru.com/gld-kanri/data/uploads/2024/08/CONVERSE_CC08-1536x1024.jpg" alt="ì•„ì´í…œ 3">
        <div class="themed-card-content">
          <h5>æ–°ä½œã‚¹ãƒ‹ãƒ¼ã‚«ãƒ¼</h5>
          <p>æ—…ã®å¿…é ˆã‚¢ã‚¤ãƒ†ãƒ </p>
        </div>
      </a>
    </div>
  </section>

  <footer class="site-footer">
    <div class="footer-content">
      <a href="#" class="footer-logo">
        <img src="https://japankuru.com/gld-kanri/data/themes/japankuru/assets/images/logo.svg" alt="Japankuru Logo">
      </a>
      <p class="footer-about">æ—¥æœ¬ã®ã™ã¹ã¦ã‚’æ·±ãã€é¢ç™½ãã€‚Japankuruã¨å…±ã«ã™ã‚‹ç‰¹åˆ¥ãªæ—…è¡Œã€‚</p>
      <ul class="footer-links">
        <li><a href="#">ä¼šç¤¾ç´¹ä»‹</a></li>
        <li><a href="#">ã™ã¹ã¦ã®ã‚¯ãƒ¼ãƒãƒ³</a></li>
        <li><a href="#">ãŠå•ã„åˆã‚ã›</a></li>
        <li><a href="#">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼</a></li>
      </ul>
      <div style="margin-top:22px;">
        <a href="#"><img src="https://scdn.line-apps.com/n/line_add_friends/btn/ja.png" alt="Line" style="height:30px;vertical-align:middle;"></a>
        <span style="font-size:15px;margin-left:10px;">å…¬å¼LINEã§æœ€æ–°ã‚¯ãƒ¼ãƒãƒ³é…ä¿¡ä¸­ï¼</span>
      </div>
      <div class="footer-copyright">Â© 2025 Japankuru. All Rights Reserved.</div>
    </div>
  </footer>
  <div id="toast" class="toast-notification"></div>

<script src="https://cdn.jsdelivr.net/npm/swiper@9/swiper-bundle.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  // --- DOM ê°ì²´ ---
  const dom = {
    swiper: document.querySelector('.swiper'),
    swiperWrapper: document.querySelector('.swiper-wrapper'),
    controlsContainer: document.querySelector('.controls-container'),
    sortSelect: document.getElementById('sort-select'),
    searchInput: document.getElementById('coupon-search'),
    condBar: document.getElementById('cond-bar'),
    emptyState: document.querySelector('.empty-state'),
    themeToggle: document.querySelector('.theme-toggle'),
    allSlides: Array.from(document.querySelectorAll('.swiper-slide')),
    resetBtn: document.querySelector('.empty-state .reset-btn'),
    viewSwitcher: document.querySelector('.view-switcher'),
    mapContainer: document.getElementById('map-container'),
    swiperPagination: document.querySelector('.swiper-pagination'),
    swiperPrev: document.querySelector('.swiper-button-prev'),
    swiperNext: document.querySelector('.swiper-button-next'),
  };
  const state = {
    swiper: null,
    savedCouponIds: [],
    userLocation: null,
    map: null,
    mapMarkers: [],
    currentView: 'list',
    categoryIcons: {
      electronics: 'fa-solid fa-laptop',
      fashion: 'fa-solid fa-shirt',
      dining: 'fa-solid fa-utensils',
      transport: 'fa-solid fa-train-subway',
      default: 'fa-solid fa-tags'
    }
  };

  // --- Swiper ì´ˆê¸°í™” ---
  function initSwiper() {
    state.swiper = new Swiper(dom.swiper, {
      observer: true,
      observeParents: true,
      loop: false,
      grabCursor: true,
      slidesPerView: 3,
      spaceBetween: 16,
      centeredSlides: false,
      centerInsufficientSlides: true,
      centeredSlidesBounds: true,
      pagination: { el: '.swiper-pagination', clickable: true },
      navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' },
      breakpoints: { 768: { slidesPerView: 'auto', spaceBetween: 24, centeredSlides: true, centerInsufficientSlides: true } }
    });
  }

  function setupCards() {
    dom.allSlides = Array.from(document.querySelectorAll('.swiper-slide')); // í•­ìƒ ìƒˆë¡œ!
    dom.allSlides.forEach(slide => {
    const scene     = slide.querySelector('.coupon-card-scene');
    const cardElem  = slide.querySelector('.coupon-card');
    const ctaBtn    = slide.querySelector('.card-cta-button');

    // ì €ì¥ ë²„íŠ¼
    const saveBtn = slide.querySelector('.save-btn');
    saveBtn.onclick = e => {
      e.stopPropagation();
      toggleSaveCoupon(scene.dataset.couponId);
    };

    // ì¹´ë“œ ì•ë©´ í´ë¦­(í˜¹ì€ CTA ë²„íŠ¼) â†’ ë°”ë¡œ flip
    [cardElem, ctaBtn].forEach(btn => {
      if (!btn) return;
      btn.onclick = function(e) {
        // ì €ì¥/ë’¤ì§‘ê¸°/ê³µìœ  ë²„íŠ¼ í´ë¦­ì‹œ ë¬´ì‹œ
        if (
          e.target.closest('.save-btn')   ||
          e.target.closest('.flip-back-btn') ||
          e.target.closest('.share-btn')
        ) return;
        // ë°”ë¡œ ì¹´ë“œ ìì²´ flip!
        scene.classList.toggle('is-flipped');
      };
    });

    // ë’·ë©´ ë³µê·€ ë²„íŠ¼ â†’ ë‹¤ì‹œ ì•ë©´ìœ¼ë¡œ
    const backBtn = slide.querySelector('.flip-back-btn');
    if (backBtn) {
      backBtn.onclick = function(e) {
        e.stopPropagation();
        scene.classList.remove('is-flipped');
      };
    }

    // ì¹´í…Œê³ ë¦¬ ì•„ì´ì½˜
    const iconContainer = slide.querySelector('.card-category-icon');
    if (iconContainer && scene) {
      const category  = scene.dataset.category || 'default';
      const iconClass = state.categoryIcons[category] || state.categoryIcons.default;
      iconContainer.innerHTML = `<i class="${iconClass}"></i>`;
    }
  });

  updateSaveButtonsVisuals();}

  function updateSaveButtonsVisuals() {
  document.querySelectorAll('.coupon-card-scene').forEach(scene => {
    const btn = scene.querySelector('.save-btn');
    const id  = scene.dataset.couponId;
    if (!btn) return;
    if (state.savedCouponIds.includes(id)) {
      btn.classList.add('is-saved');
      btn.innerHTML = '<i class="fa-solid fa-star"></i>'; // ì €ì¥ë¨(â˜…)
    } else {
      btn.classList.remove('is-saved');
      btn.innerHTML = '<i class="fa-regular fa-star"></i>'; // ì €ì¥ ì „(â˜†)
    }
  });
}
  // --- ì§€ë„ ì´ˆê¸°í™” ---
  function initMap() {
    if (!dom.mapContainer) return;
    state.map = L.map(dom.mapContainer).setView([35.6895, 139.6917], 12);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19, attribution: 'Â© OpenStreetMap' }).addTo(state.map);
  }

  // --- ë§ˆì»¤ ë™ê¸°í™” ---
  function updateMapMarkers(visibleCards) {
    if (!state.map) return;
    state.mapMarkers.forEach(m => m.remove());
    state.mapMarkers = [];
    const bounds = [];
    visibleCards.forEach(card => {
      const lat = parseFloat(card.dataset.lat), lon = parseFloat(card.dataset.lon);
      if (!lat||!lon) return;
      const marker = L.marker([lat,lon]).addTo(state.map);
      marker.bindPopup(`<h4>${card.querySelector('.card-store-name').textContent}</h4><p>${card.querySelector('.card-offer').textContent}</p>`);
      state.mapMarkers.push(marker);
      bounds.push([lat,lon]);
    });
    if (bounds.length) state.map.fitBounds(bounds, { padding: [50,50] });
  }


  // --- ì €ì¥/ì œê±° ---
  function toggleSaveCoupon(id) {
    const idx = state.savedCouponIds.indexOf(id);
    let msg;
    if (idx===-1) { state.savedCouponIds.push(id); msg='ä¿å­˜æ¸ˆã¿ã«è¿½åŠ ã—ã¾ã—ãŸï¼'; }
    else { state.savedCouponIds.splice(idx,1); msg='ä¿å­˜æ¸ˆã¿ã‹ã‚‰å‰Šé™¤ã—ã¾ã—ãŸã€‚'; }
    localStorage.japankuruSavedCoupons = JSON.stringify(state.savedCouponIds);
    updateSaveButtonsVisuals(); updateFilterCounts(); showToast(msg); updateView();
    state.swiper.update(); state.swiper.slideTo(0,0);
  }

  // --- ê±°ë¦¬ê³„ì‚° & ì£¼ë³€í•„í„° ---
  function calculateDistance(lat1,lon1,lat2,lon2) {
    const R=6371; const dLat=(lat2-lat1)*Math.PI/180, dLon=(lon2-lon1)*Math.PI/180;
    const a=Math.sin(dLat/2)**2 + Math.cos(lat1*Math.PI/180)*Math.cos(lat2*Math.PI/180)*Math.sin(dLon/2)**2;
    return R*2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));
  }
  function filterNearby() {
    if (!navigator.geolocation) { alert('ä½ç½®æƒ…å ±æœªå¯¾å¿œ'); return; }
    navigator.geolocation.getCurrentPosition(pos => {
      const [uLat,uLon] = [pos.coords.latitude,pos.coords.longitude];
      dom.allSlides.forEach(slide => {
        const scene = slide.querySelector('.coupon-card-scene');
        const lat=parseFloat(scene.dataset.lat), lon=parseFloat(scene.dataset.lon);
        const d=lat&&lon?calculateDistance(uLat,uLon,lat,lon):9999;
        scene.dataset.distance=d;
      });
      dom.allSlides.sort((a,b)=>a.querySelector('.coupon-card-scene').dataset.distance - b.querySelector('.coupon-card-scene').dataset.distance)
        .forEach(s=>dom.swiperWrapper.appendChild(s));
      updateView();
    },()=>alert('ä½ç½®æƒ…å ±å–å¾—å¤±æ•—'));
  }

  // --- í•„í„° ì¹´ìš´íŠ¸ (ìˆ˜ì •) ---
  function updateFilterCounts() {
    dom.controlsContainer.querySelectorAll('.filter-btn').forEach(btn=>{
      const f=btn.dataset.filter;
      let count=0;
      if (f==='all') count=dom.allSlides.length;
      else if (f==='saved') count=dom.allSlides.filter(s=>state.savedCouponIds.includes(s.querySelector('.coupon-card-scene').dataset.couponId)).length;
      else if (f==='nearby') count=dom.allSlides.length;
      else count=dom.allSlides.filter(s=>s.querySelector('.coupon-card-scene').dataset.category===f).length;
      let span=btn.querySelector('.count');
      if (!span) { span=document.createElement('span'); span.className='count'; btn.appendChild(span); }
      span.textContent = ` (${count})`;
    });
  }

  // --- ê²€ìƒ‰ ì…ë ¥ ì„¤ì • ---
  function setupSearchInput() {
    dom.searchInput.addEventListener('input',updateView);
    dom.searchInput.addEventListener('keydown',e=>{ if(e.key==='Enter') updateView(); });
  }

  // --- ì •ë ¬ & í•„í„°ë§ & Swiper ì¬ìƒì„± ---
  function updateView() {
    state.masterSlides = Array.from(document.querySelectorAll('.swiper-slide'));
    // 1) í˜„ì¬ ì„ íƒëœ í•„í„°ì™€ ê²€ìƒ‰ì–´ ê°€ì ¸ì˜¤ê¸°
  const filter = dom.controlsContainer.querySelector('.filter-btn.active').dataset.filter;
  const term   = dom.searchInput.value.trim().toLowerCase();

  // 2) ê²€ìƒ‰ì–´Â·ì¹´í…Œê³ ë¦¬Â·ì €ì¥ì¿ í° í•„í„°ë§
  let filtered = state.masterSlides.filter(slide => {
    const scene = slide.querySelector('.coupon-card-scene');
    const text  = scene.textContent.toLowerCase();
    if (term && !text.includes(term)) return false;
    if (filter === 'saved') {
      return state.savedCouponIds.includes(scene.dataset.couponId);
    }
    if (filter !== 'all' && filter !== 'nearby' && scene.dataset.category !== filter) {
      return false;
    }
    return true;
  });

  // 3) ì •ë ¬ ë¡œì§
  const sortBy = dom.sortSelect.value;
  if (sortBy === 'expiry') {
    filtered.sort((a, b) =>
      a.querySelector('.coupon-card-scene').dataset.expiry
        .localeCompare(b.querySelector('.coupon-card-scene').dataset.expiry)
    );
  } else if (sortBy === 'discount') {
    const num = el => +(el.querySelector('.card-offer').textContent.match(/(\d+)/)||[0,0])[1];
    filtered.sort((a, b) => num(b) - num(a));
  } else if (filter === 'nearby') {
    filtered.sort((a, b) =>
      +a.querySelector('.coupon-card-scene').dataset.distance
      - +b.querySelector('.coupon-card-scene').dataset.distance
    );
  } else {
    filtered.sort((a, b) =>
      (+a.dataset.originalOrder) - (+b.dataset.originalOrder)
    );
  }
    if(state.swiper) { state.swiper.destroy(true,true); state.swiper=null; }
    dom.swiperWrapper.innerHTML=''; filtered.forEach(s=>dom.swiperWrapper.appendChild(s));
    initSwiper();
    dom.emptyState.classList.toggle('show',filtered.length===0);
    updateFilterCounts();
    if(state.currentView==='map') updateMapMarkers(filtered.map(s=>s.querySelector('.coupon-card-scene')));
    setupCards();
  }

  // --- í† ìŠ¤íŠ¸ & í…Œë§ˆ ---
  function showToast(msg){ const t=dom.emptyState.ownerDocument.getElementById('toast'); t.textContent=msg; t.classList.add('show'); setTimeout(()=>t.classList.remove('show'),1600);}  
  function toggleTheme(){ document.body.classList.toggle('dark-mode'); localStorage.japankuruTheme=document.body.classList.contains('dark-mode')?'dark':'light'; }


// --- ì´ë²¤íŠ¸ ë°”ì¸ë”© ---
function bindEventListeners() {
  // 1) ê²€ìƒ‰ ì…ë ¥ ì´ë²¤íŠ¸
  dom.searchInput.addEventListener('input', updateView);
  dom.searchInput.addEventListener('keydown', e => {
    if (e.key === 'Enter') updateView();
  });

  // 2) ì •ë ¬(select) ì´ë²¤íŠ¸
  dom.sortSelect.addEventListener('change', updateView);

  // 3) í•„í„° ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
  dom.controlsContainer.addEventListener('click', e => {
    const btn = e.target.closest('.filter-btn');
    if (!btn || btn.classList.contains('active')) return;
    // ê¸°ì¡´ active ë¹„í™œì„±í™”
    dom.controlsContainer
      .querySelectorAll('.filter-btn.active')
      .forEach(b => b.classList.remove('active'));
    // í´ë¦­í•œ ë²„íŠ¼ë§Œ í™œì„±í™”
    btn.classList.add('active');

    // â€œå‘¨è¾ºâ€ ì€ ë³„ë„ ì²˜ë¦¬, ê·¸ ì™¸ì—” updateView()
    if (btn.dataset.filter === 'nearby') {
      filterNearby();
    } else {
      updateView();
    }
  });

  // 4) ë·° ì „í™˜ (ë¦¬ìŠ¤íŠ¸ â†” ì§€ë„)
  dom.viewSwitcher.addEventListener('click', e => {
    const btn = e.target.closest('.view-btn');
    if (!btn || btn.classList.contains('active')) return;
    dom.viewSwitcher.querySelector('.active').classList.remove('active');
    btn.classList.add('active');
    state.currentView = btn.dataset.view;
    const isMap = state.currentView === 'map';
    dom.swiper.style.display     = isMap ? 'none' : 'block';
    dom.mapContainer.style.display = isMap ? 'block' : 'none';
    if (isMap) {
      state.map.invalidateSize();
      updateView();
    }
  });

  // 5) í…Œë§ˆ í† ê¸€
  dom.themeToggle.addEventListener('click', toggleTheme);

  // 6) ë¦¬ì…‹ ë²„íŠ¼
  dom.resetBtn && dom.resetBtn.addEventListener('click', resetLogic);
  dom.condBar  && dom.condBar.addEventListener('click', e => {
    if (e.target.classList.contains('reset-btn')) resetLogic();
  });

  // 7) ê³µìœ  ë²„íŠ¼ (delegation)
  document.body.addEventListener('click', handleShareClick);

  // 8) ì„œì¹˜ì•„ì´ì½˜ í´ë¦­ (if ë³„ë„ ë²„íŠ¼ì´ ìˆë‹¤ë©´)
  setupSearchInput();
}

  // --- ì´ˆê¸°í™” ---
  function init(){
    state.masterSlides = Array.from(document.querySelectorAll('.swiper-slide'));
    try{ state.savedCouponIds = JSON.parse(localStorage.japankuruSavedCoupons||'[]'); }catch{state.savedCouponIds=[];}
    if(localStorage.japankuruTheme==='dark') document.body.classList.add('dark-mode');
    initSwiper(); initMap(); updateFilterCounts(); bindEventListeners(); updateView();
    // ê±°ë¦¬ ë°°ì§€ ì´ë™
    document.querySelectorAll('.coupon-card-scene').forEach(scene=>{
      const badge=scene.querySelector('.distance-badge'), wrap=scene.querySelector('.card-image-wrapper');
      wrap && badge && wrap.appendChild(badge);
    });
  }

  init();
});
</script>


</body>
</html>
